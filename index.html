<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oppa | Elite Hub</title>
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/2098/2098402.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    <style>
        body { transition: background-color 0.3s; -webkit-tap-highlight-color: transparent; font-family: sans-serif; }
        .dark body { background-color: #0f172a; color: #e2e8f0; }
        body:not(.dark) { background-color: #f8fafc; color: #1e293b; }
        .bg-card { background-color: white; border: 1px solid #e2e8f0; }
        .dark .bg-card { background-color: #1e293b; border-color: #334155; }
        .cube-checkbox { width: 20px; height: 20px; border: 2px solid #64748b; cursor: pointer; border-radius: 4px; }
        .checked { background-color: #10b981; border-color: #10b981; }
        .checked::after { content: '‚úî'; color: white; position: absolute; left: 3px; top: -2px; font-size: 12px; }
        .nav-btn { flex: 1; padding: 10px; display: flex; flex-direction: column; align-items: center; font-size: 10px; font-weight: bold; opacity: 0.5; }
        .nav-btn.active { opacity: 1; color: #3b82f6; }
        .calendar-day { min-height: 45px; cursor: pointer; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; border: 1px solid transparent; }
        .active-day { border: 2px solid #3b82f6 !important; }
        .dot { width: 4px; height: 4px; background: #3b82f6; border-radius: 50%; position: absolute; bottom: 4px; }
        input, textarea { width: 100%; background: transparent; border: 1px solid #cbd5e1; padding: 8px; border-radius: 6px; outline: none; }
        .dark input, .dark textarea { border-color: #334155; color: white; }
    </style>
</head>
<body class="p-4 pb-24 dark">
    <div class="max-w-md mx-auto">
        <header class="flex justify-between items-center mb-4">
            <h1 class="text-xl font-bold italic">OPPA <span class="text-blue-500">ELITE</span></h1>
            <button onclick="toggleTheme()" class="p-2 rounded-full bg-slate-200 dark:bg-slate-800" id="themeBtn">üåô</button>
        </header>

        <div id="pinnedSection" class="bg-gradient-to-r from-blue-600 to-indigo-700 p-3 rounded-lg mb-6 text-white text-center shadow-lg hidden">
            <p id="pinnedText" class="text-sm font-medium italic"></p>
        </div>

        <div class="bg-card p-3 rounded-xl mb-6 shadow-md">
            <div class="flex justify-between items-center mb-2">
                <button onclick="changeMonth(-1)">‚óÄ</button>
                <div id="monthLabel" class="font-bold text-sm uppercase"></div>
                <button onclick="changeMonth(1)">‚ñ∂</button>
            </div>
            <div class="grid grid-cols-7 gap-1 text-[8px] text-center font-bold opacity-50 mb-1">
                <div>SUN</div><div>MON</div><div>TUE</div><div>WED</div><div>THU</div><div>FRI</div><div>SAT</div>
            </div>
            <div id="calendarGrid" class="grid grid-cols-7 gap-1"></div>
        </div>

        <div id="content" class="bg-card p-4 rounded-xl shadow-lg min-height-[300px]">
            <h2 id="viewTitle" class="text-xs font-black text-blue-500 uppercase mb-4">Tasks</h2>
            <div id="screen-tasks" class="space-y-4">
                <input type="text" id="taskIn" placeholder="+ Add Task (Enter)" onkeypress="handleKey(event, 'task')" class="mb-4">
                <div id="taskList" class="space-y-4"></div>
            </div>
            <div id="screen-countdown" class="hidden space-y-4">
                <input type="text" id="cdName" placeholder="Exam Name (e.g. CA Law)" class="mb-2">
                <input type="date" id="cdDate" class="mb-2">
                <button onclick="addCD()" class="w-full bg-blue-600 text-white py-2 rounded font-bold text-xs">ADD COUNTDOWN</button>
                <div id="cdList" class="space-y-2 mt-4"></div>
            </div>
            <div id="screen-events" class="hidden space-y-4">
                <input type="text" id="evIn" placeholder="+ New Event (Enter)" onkeypress="handleKey(event, 'event')">
                <div id="evList" class="space-y-2"></div>
            </div>
            <div id="screen-diary" class="hidden space-y-4">
                <textarea id="diaryIn" rows="5" placeholder="Write your thoughts or a motivation quote..." class="mb-2"></textarea>
                <button onclick="pinQuote()" class="w-full bg-indigo-600 text-white py-2 rounded font-bold text-xs uppercase">Pin to Home Page</button>
                <div id="diaryList" class="text-xs opacity-70 mt-4 italic"></div>
            </div>
        </div>

        <nav class="fixed bottom-0 left-0 right-0 bg-card border-t border-slate-200 dark:border-slate-800 flex justify-around shadow-2xl p-1">
            <button onclick="showScreen('tasks')" class="nav-btn active" id="btn-tasks"><span>üìã</span>Tasks</button>
            <button onclick="showScreen('countdown')" class="nav-btn" id="btn-countdown"><span>‚è≥</span>Exams</button>
            <button onclick="showScreen('events')" class="nav-btn" id="btn-events"><span>üìÖ</span>Events</button>
            <button onclick="showScreen('diary')" class="nav-btn" id="btn-diary"><span>üìî</span>Diary</button>
        </nav>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('oppa_db')) || { tasks: {}, exams: [], events: {}, diary: "" };
        let curDate = new Date();
        let selDate = new Date().toISOString().split('T')[0];

        function showScreen(s) {
            ['tasks', 'countdown', 'events', 'diary'].forEach(id => {
                document.getElementById('screen-'+id).classList.add('hidden');
                document.getElementById('btn-'+id).classList.remove('active');
            });
            document.getElementById('screen-'+s).classList.remove('hidden');
            document.getElementById('btn-'+s).classList.add('active');
            document.getElementById('viewTitle').innerText = s;
            if(s === 'tasks' || s === 'events') renderData();
            if(s === 'countdown') renderCD();
        }

        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            const y = curDate.getFullYear(), m = curDate.getMonth();
            document.getElementById('monthLabel').innerText = new Intl.DateTimeFormat('en-US', {month:'long', year:'numeric'}).format(curDate);
            const start = new Date(y, m, 1).getDay(), days = new Date(y, m+1, 0).getDate();
            for(let i=0; i<start; i++) grid.appendChild(document.createElement('div'));
            for(let i=1; i<=days; i++) {
                const dStr = `${y}-${(m+1).toString().padStart(2, '0')}-${i.toString().padStart(2, '0')}`;
                const d = document.createElement('div');
                d.className = `calendar-day ${selDate === dStr ? 'active-day' : ''}`;
                d.innerHTML = `<span>${i}</span>`;
                if(db.tasks[dStr] && db.tasks[dStr].some(t => !t.done)) {
                    const dot = document.createElement('div'); dot.className = 'dot'; d.appendChild(dot);
                }
                d.onclick = () => { selDate = dStr; renderCalendar(); renderData(); };
                grid.appendChild(d);
            }
        }

        function renderData() {
            const tList = document.getElementById('taskList'), eList = document.getElementById('evList');
            tList.innerHTML = ''; eList.innerHTML = '';
            (db.tasks[selDate] || []).forEach((t, i) => {
                tList.innerHTML += `<div class="flex items-start gap-3 p-2 bg-slate-100 dark:bg-slate-800 rounded">
                    <div class="cube-checkbox ${t.done?'checked':''}" onclick="toggleT(${i})"></div>
                    <p class="text-sm ${t.done?'line-through opacity-50':''}">${t.text}</p>
                </div>`;
            });
            (db.events[selDate] || []).forEach((e, i) => {
                eList.innerHTML += `<div class="p-2 border-l-4 border-blue-500 bg-slate-100 dark:bg-slate-800 text-xs">${e}</div>`;
            });
        }

        function renderCD() {
            const list = document.getElementById('cdList'); list.innerHTML = '';
            db.exams.forEach((ex, i) => {
                const diff = Math.ceil((new Date(ex.date) - new Date()) / 86400000);
                list.innerHTML += `<div class="flex justify-between p-3 bg-red-900/20 border border-red-900/30 rounded text-xs">
                    <span class="font-bold">${ex.name}</span>
                    <span class="text-red-500 font-black">${diff} DAYS LEFT</span>
                </div>`;
            });
        }

        function handleKey(e, type) {
            if(e.key === 'Enter' && e.target.value) {
                if(type === 'task') {
                    if(!db.tasks[selDate]) db.tasks[selDate] = [];
                    db.tasks[selDate].push({text: e.target.value, done: false, subs: []});
                } else {
                    if(!db.events[selDate]) db.events[selDate] = [];
                    db.events[selDate].push(e.target.value);
                }
                e.target.value = ''; save(); renderCalendar();
            }
        }

        function addCD() {
            const name = document.getElementById('cdName').value, date = document.getElementById('cdDate').value;
            if(name && date) { db.exams.push({name, date}); save(); renderCD(); }
        }

        function pinQuote() {
            db.diary = document.getElementById('diaryIn').value;
            document.getElementById('pinnedSection').classList.remove('hidden');
            document.getElementById('pinnedText').innerText = db.diary;
            save();
        }

        function toggleT(i) { db.tasks[selDate][i].done = !db.tasks[selDate][i].done; save(); renderCalendar(); }
        function save() { localStorage.setItem('oppa_db', JSON.stringify(db)); renderData(); }
        function changeMonth(o) { curDate.setMonth(curDate.getMonth() + o); renderCalendar(); }
        function toggleTheme() { document.body.classList.toggle('dark'); }

        renderCalendar(); showScreen('tasks');
        if(db.diary) { document.getElementById('pinnedSection').classList.remove('hidden'); document.getElementById('pinnedText').innerText = db.diary; }
    </script>
</body>
</html>
